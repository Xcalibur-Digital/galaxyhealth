import{i as De,g as Ae,a as xe,G as Re,j as e,C as Ee,S as b,L as ue,T as n,b as E,A as q,I as Q,R as Ne,B as I,r as x,o as js,d as T,c as me,s as le,e as fs,u as _,f as Le,N as ys,h as R,k as Te,D as V,l as Me,m as vs,n as pe,p as He,q as Ve,t as bs,v as ge,w as Be,x as Ge,y as c,z as ws,E as ie,F as Cs,H as F,P as C,J as D,K as Ss,M as zs,O as W,Q as je,U as Oe,V as Fe,W as Is,X as Ue,Y as Ps,Z as ks,_ as Ds,$ as he,a0 as $e,a1 as te,a2 as N,a3 as ne,a4 as fe,a5 as As,a6 as M,a7 as ee,a8 as re,a9 as P,aa as _e,ab as We,ac as Rs,ad as Es,ae as Ns,af as Ls,ag as Ts,ah as Ms,ai as Hs,aj as Vs,ak as k,al as Bs,am as Gs,an as Os,ao as Fs,ap as z,aq as qe,ar as Qe,as as Us,at as K,au as $s,av as _s,aw as ye,ax as Je,ay as Ke,az as Ws,aA as Ye,aB as qs,aC as Qs,aD as Ze,aE as $,aF as Xe,aG as oe,aH as es,aI as ss,aJ as Js,aK as Ks,aL as ve,aM as Ys,aN as Zs,aO as Xs,aP as et,aQ as st,aR as tt,aS as it,aT as ts,aU as ce,aV as rt,aW as at,aX as de,aY as nt,aZ as se,a_ as ot,a$ as Se,b0 as lt,b1 as ct,b2 as dt,b3 as ze,b4 as Ie,b5 as ht,b6 as xt,b7 as ut,b8 as mt,b9 as pt,ba as be,bb as gt,bc as jt,bd as ft,be as yt,bf as B,bg as vt}from"./vendor.B_fBlNpi.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function i(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=i(a);fetch(a.href,o)}})();const we={apiKey:"AIzaSyBm2rIxMiZUxMWtzewLz1s6hZeNQEDvm6s",authDomain:"galaxyhealth.firebaseapp.com",projectId:"galaxyhealth",storageBucket:"galaxyhealth.appspot.com",messagingSenderId:"415572460225",appId:"1:415572460225:web:0e67f8d39701a6699d0a40"},is=De(we),L=Ae(is),Z=xe(is);new Re;const ae=({message:s="Loading..."})=>e.jsx(Ee,{style:{height:"100%",minHeight:200},children:e.jsxs(b,{align:"center",spacing:"xs",children:[e.jsx(ue,{size:"lg"}),e.jsx(n,{size:"sm",color:"dimmed",children:s})]})}),bt=({error:s})=>e.jsx(E,{size:"sm",py:"xl",children:e.jsx(q,{icon:e.jsx(Q,{size:16}),title:"Error",color:"red",variant:"filled",children:(s==null?void 0:s.message)||"An unexpected error occurred"})}),wt=(s,t={})=>{console.error("Error:",{message:s.message,code:s.code,context:t,stack:s.stack})};class li extends Ne.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,i){wt(t,{component:"ErrorBoundary",info:i})}render(){var t;return this.state.hasError?e.jsx(E,{size:"sm",py:"xl",children:e.jsx(q,{icon:e.jsx(Q,{size:16}),title:"Something went wrong",color:"red",variant:"filled",children:e.jsxs(b,{spacing:"md",children:[e.jsx("div",{children:((t=this.state.error)==null?void 0:t.message)||"An unexpected error occurred"}),e.jsx(I,{variant:"white",onClick:()=>window.location.reload(),children:"Reload Page"})]})})}):this.props.children}}const rs=x.createContext(null),J=()=>{const s=x.useContext(rs);if(!s)throw new Error("useUser must be used within a UserProvider");return s},Ct=({children:s})=>{console.log("UserProvider initializing");const[t,i]=x.useState(null),[r,a]=x.useState(!0),[o,u]=x.useState(null),l=async d=>{try{const m=new Date().toISOString(),p=d.email==="brendansmithelion@gmail.com",h={uid:d.uid,email:d.email,displayName:d.displayName||d.email,photoURL:d.photoURL,role:p?"admin":"user",registeredAt:m,createdAt:m,lastUpdated:m,isActive:!0,accountStatus:"active"},g=T(L,"users",d.uid);await le(g,h);const S=T(L,"userSettings",d.uid),y={theme:"dark",notifications:!0,dashboardLayout:"default",language:"en",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,createdAt:m,updatedAt:m};await le(S,y);const w=T(L,"userPreferences",d.uid);return await le(w,{favoritePatients:[],recentSearches:[],customViews:[],shortcuts:[],createdAt:m,updatedAt:m}),h}catch(m){throw console.error("Error creating new user:",m),m}};x.useEffect(()=>{console.log("Setting up auth listener");const d=xe();let m;try{m=js(d,async p=>{console.log("Auth state changed:",p?"User logged in":"No user");try{if(a(!0),console.log("Current firebaseUser:",p==null?void 0:p.email),p){const h=T(L,"users",p.uid);console.log("Attempting to read user document for:",p.uid);try{const g=await me(h);console.log("Document exists?",g.exists());let S;g.exists()?(S=g.data(),console.log("Retrieved user data:",S)):(console.log("Creating new user document"),S=await l(p)),i({...p,...S})}catch(g){throw console.error("Specific Firestore error:",{code:g.code,message:g.message,details:g}),g}}else i(null)}catch(h){console.error("Auth state change error:",{code:h.code,message:h.message,details:h}),u(h)}finally{a(!1)}})}catch(p){console.error("Auth setup error:",p),u(p),a(!1)}return()=>m==null?void 0:m()},[]);const j={user:t,loading:r,error:o,login:async d=>{i(d)},logout:async()=>{try{await fs(Z),i(null)}catch(d){throw console.error("Logout error:",d),d}},makeAdmin:async()=>{try{const d=T(L,"users",t.uid);await _(d,{role:"admin",updatedAt:new Date().toISOString()}),await Z.currentUser.getIdToken(!0),window.location.reload()}catch(d){console.error("Error making user admin:",d)}}};return r?e.jsx(ae,{}):o?e.jsx(bt,{error:o}):e.jsx(rs.Provider,{value:j,children:s})},St=Me(s=>({navbar:{backgroundColor:s.colorScheme==="dark"?s.colors.dark[7]:s.white,height:"100vh"},navItem:{display:"flex",alignItems:"center",padding:s.spacing.md,borderRadius:s.radius.md,transition:"all 200ms ease",color:s.colorScheme==="dark"?s.colors.dark[0]:s.colors.gray[7],"&:hover":{backgroundColor:s.colorScheme==="dark"?s.colors.dark[6]:s.colors.gray[0]},'&[data-active="true"]':{backgroundColor:s.fn.variant({variant:"light",color:"blue"}).background,color:s.fn.variant({variant:"light",color:"blue"}).color,"& .nav-icon":{color:s.fn.variant({variant:"light",color:"blue"}).color}},[s.fn.smallerThan("sm")]:{padding:s.spacing.xs,borderRadius:0,'&[data-active="true"]':{borderRadius:0}}},navIcon:{color:s.colorScheme==="dark"?s.colors.dark[2]:s.colors.gray[6],marginRight:s.spacing.sm,[s.fn.smallerThan("sm")]:{marginRight:0}},navLabel:{[s.fn.smallerThan("sm")]:{fontSize:s.fontSizes.xs}},mobileNav:{display:"flex",flexDirection:"column"},divider:{marginBottom:s.spacing.xs}})),zt=()=>{const{classes:s}=St(),t=Le(),i=[{id:"dashboard",icon:vs,label:"Home",to:"/dashboard"},{id:"patients",icon:pe,label:"My Patients",to:"/patients"},{id:"performance",icon:He,label:"Performance",to:"/performance"},{id:"ehr-alerts",icon:Ve,label:"EHR Alerts",to:"/ehr-alerts"},{id:"admin",icon:bs,label:"Admin",to:"/patient-context"}],r={id:"settings",icon:ge,label:"Settings",to:"/settings"},a=l=>t.pathname===l,o={initial:{opacity:0,x:-20},animate:{opacity:1,x:0,transition:{duration:.2}},exit:{opacity:0,x:20,transition:{duration:.2}}},u=({icon:l,label:j,to:d,index:m,id:p})=>e.jsx(Be.div,{variants:o,initial:"initial",animate:"animate",exit:"exit",transition:{delay:m*.1},children:e.jsx(R,{component:Ge,to:d,className:s.navItem,"data-active":a(d),children:e.jsxs(c,{spacing:"sm",noWrap:!0,children:[e.jsx(l,{size:20,className:s.navIcon+" nav-icon"}),e.jsx(n,{className:s.navLabel,children:j})]})})},p);return e.jsx(ys,{p:"md",className:s.navbar,width:{base:250},children:e.jsxs(b,{spacing:"xs",className:s.mobileNav,sx:{height:"100%"},children:[e.jsx(R,{sx:{flex:1},children:e.jsx(Te,{mode:"sync",children:i.map((l,j)=>e.jsx(u,{...l,index:j},l.id))})}),e.jsxs(R,{children:[e.jsx(V,{className:s.divider}),e.jsx(u,{...r,index:i.length},r.id)]})]})})},It=({onGoogleSignIn:s})=>{const[t,i]=x.useState(""),[r,a]=x.useState(""),[o,u]=x.useState(!1),[l,j]=x.useState(""),d=async m=>{m.preventDefault(),u(!0);try{await Cs(Z,t,r)}catch(p){j(p.message)}finally{u(!1)}};return e.jsxs(R,{sx:{maxWidth:300},mx:"auto",children:[e.jsx(b,{spacing:"md",children:e.jsx(I,{leftIcon:e.jsx(ws,{size:16}),variant:"default",onClick:s,fullWidth:!0,children:"Continue with Google"})}),e.jsx(V,{label:"Or",labelPosition:"center",mb:"md"}),e.jsxs("form",{onSubmit:d,children:[e.jsx(ie,{required:!0,label:"Email",value:t,onChange:m=>i(m.target.value),error:l,mb:"md"}),e.jsx(ie,{required:!0,type:"password",label:"Password",value:r,onChange:m=>a(m.target.value),mb:"md"}),e.jsx(c,{position:"right",children:e.jsx(I,{type:"submit",loading:o,children:"Sign In"})})]})]})},as=De(we),U=Ae(as),Y=xe(as),Pt=new Re,kt=!1;kt&&(typeof window<"u"&&(window.firebase={firestore:U}),console.log("Firebase config:",{...we,apiKey:"HIDDEN"}));const Dt=()=>{const s=F(),t=async()=>{try{const i=await Ss(Y,Pt);console.log("Google sign in successful:",i.user),s("/dashboard")}catch(i){console.error("Google sign in error:",i),i.code==="auth/popup-blocked"?alert("Please allow popups for this site"):alert("Error signing in with Google")}};return e.jsx(E,{size:"sm",py:"xl",children:e.jsxs(C,{radius:"md",p:"xl",withBorder:!0,children:[e.jsx(D,{order:2,align:"center",mb:"xl",children:"Welcome to Galaxy Health"}),e.jsx(It,{onGoogleSignIn:t})]})})},X=zs((s,t)=>(console.log("Creating notification store"),{notifications:[],loading:!0,error:null,initialize:()=>{console.log("Initializing notifications");let i=()=>{};try{if(!Y.currentUser)return console.log("No authenticated user"),s({loading:!1}),()=>{};console.log("Setting up Firestore listener for:",Y.currentUser.uid);const r=W(U,"notifications"),a=je(r,Oe("userId","==",Y.currentUser.uid),Fe("timestamp","desc"),Is(100));i=Ue(a,o=>{const u=o.docs.map(l=>{var d,m;const j=l.data();return{id:l.id,...j,timestamp:((m=(d=j.timestamp)==null?void 0:d.toDate())==null?void 0:m.toISOString())||j.createdAt}});console.log("Received notifications:",u),s({notifications:u,loading:!1})},o=>{console.error("Error loading notifications:",o),s({error:o.message,loading:!1})})}catch(r){console.error("Error initializing notifications:",r),s({error:r.message,loading:!1})}return i},addNotification:async i=>{try{const r=Y.currentUser;if(!r){console.error("Must be authenticated to add notifications");return}const a=W(U,"notifications");await Ps(a,{...i,userId:r.uid,timestamp:ks(),createdAt:new Date().toISOString(),read:!1})}catch(r){console.error("Error adding notification:",r)}},markAsRead:async i=>{try{await _(T(U,"notifications",i),{read:!0})}catch(r){console.error("Error marking notification as read:",r)}},clearNotifications:async()=>{try{const i=Ds(U);t().notifications.forEach(a=>{const o=T(U,"notifications",a.id);i.delete(o)}),await i.commit()}catch(i){console.error("Error clearing notifications:",i)}},getUnreadCount:()=>t().notifications.filter(i=>!i.read).length})),ns=x.createContext(null),At=({children:s})=>{const[t,i]=x.useState(null),r=F(),a=X(h=>h.addNotification),[o,u]=x.useState([]),[l,j]=x.useState(!1),[d,m]=x.useState(null);x.useEffect(()=>{console.log("Setting up patient context listener"),window.testPatientContext=g=>{console.log("Testing patient context with:",g),window.postMessage({type:"PATIENT_CONTEXT_UPDATED",data:g},"*")};const h=g=>{var S,y,w;if(console.log("Received message in web app:",g),((S=g.data)==null?void 0:S.type)==="PATIENT_CONTEXT_UPDATED"){console.log("Updating patient context:",g.data.data);const v=g.data.data;i(v);const f=`${v.name[0].given.join(" ")} ${v.name[0].family}`;a({type:"PATIENT_CONTEXT",title:"Patient Context Detected",message:`Active patient: ${f}`,patientId:v.id,patientInfo:{name:f,mrn:(w=(y=v.identifier)==null?void 0:y[0])==null?void 0:w.value,id:v.id},source:v.source,appName:v.appName}),he({title:"Patient Context Detected",message:`Active patient: ${f}`,color:"blue",icon:e.jsx($e,{size:16}),autoClose:5e3,onClick:()=>r(`/patients/${v.id}`)})}};return window.addEventListener("message",h),()=>{window.removeEventListener("message",h),delete window.testPatientContext}},[r,a]);const p=async()=>{try{const h=W(L,"patients"),g=je(h,Fe("lastName","asc")),S=await te(g),y=[];return S.forEach(w=>{const v=w.data();y.push({id:w.id,firstName:v.firstName,lastName:v.lastName,dateOfBirth:v.dateOfBirth,riskLevel:v.riskLevel||"low",lastVisit:v.lastVisit,careGaps:v.careGaps||[],provider:v.provider||""})}),y}catch(h){throw console.error("Error fetching patients:",h),h}};return x.useEffect(()=>{(async()=>{j(!0);try{const g=await p();console.log("Loaded patients:",g),u(g)}catch(g){console.error("Error loading patients:",g),m(g)}finally{j(!1)}})()},[]),e.jsx(ns.Provider,{value:{activePatient:t,setActivePatient:i,patients:o,loading:l,error:d},children:s})},Ce=()=>x.useContext(ns),Rt=({patient:s})=>s?e.jsx(C,{p:"md",radius:"md",shadow:"sm",sx:t=>({backgroundColor:t.colors.blue[1],border:`1px solid ${t.colors.blue[3]}`}),children:e.jsxs(b,{spacing:"xs",children:[e.jsxs(c,{position:"apart",children:[e.jsxs(c,{children:[e.jsx($e,{size:24}),e.jsxs("div",{children:[e.jsx(n,{size:"sm",color:"dimmed",children:"Active Patient"}),e.jsxs(n,{weight:500,children:[s.name[0].given.join(" ")," ",s.name[0].family]})]})]}),e.jsx(N,{color:"blue",children:"Context Active"})]}),e.jsx(c,{position:"right",children:e.jsx(I,{component:Ge,to:`/patients/${s.id}`,variant:"light",size:"xs",rightIcon:e.jsx(ne,{size:16}),children:"View Details"})})]})}):null,G={CARE_GAPS:"care_gaps",HIGH_RISK:"high_risk",RECENT_VISITS:"recent_visits",MISSING_AWV:"missing_awv",UNCONTROLLED_CONDITIONS:"uncontrolled_conditions"},Pe=s=>{switch(s){case G.CARE_GAPS:return{careGaps:{type:"greaterThan",filter:0}};case G.HIGH_RISK:return{riskLevel:{values:["high"]}};case G.RECENT_VISITS:return{lastVisit:{type:"greaterThan",dateFrom:new Date(Date.now()-7*24*60*60*1e3).toISOString()}};case G.MISSING_AWV:return{awvStatus:{values:["missing","overdue"]}};case G.UNCONTROLLED_CONDITIONS:return{conditions:{type:"contains",filter:"uncontrolled"}};default:return{}}},Et=()=>{const s={overview:"Here's your daily patient care summary and recommended actions:",keyPoints:[{type:"alert",text:"3 high-risk diabetes patients need medication review",icon:Q,color:"red"},{type:"opportunity",text:"8 Annual Wellness Visits can be scheduled this week",icon:ee,color:"blue"},{type:"success",text:"4 patients improved their blood pressure control this month",icon:re,color:"green"}],recommendation:{priority:"high",action:"Focus on High-Risk Diabetes Patients",impact:"Early intervention could prevent complications for 3 patients with HbA1c > 9.0",nextSteps:["Review medication adherence reports","Schedule follow-up appointments","Update care management plans"]}};return e.jsxs(C,{p:"xl",radius:"md",withBorder:!0,mt:"xl",children:[e.jsx(c,{position:"apart",mb:"lg",children:e.jsxs(c,{children:[e.jsx(fe,{size:"lg",radius:"xl",sx:t=>({background:t.fn.linearGradient(45,"#6E2B81","#B82C5D")}),children:e.jsx(As,{size:24})}),e.jsxs("div",{children:[e.jsx(D,{order:3,children:"AI Summary"}),e.jsx(n,{size:"sm",color:"dimmed",children:"Updated just now"})]})]})}),e.jsx(R,{sx:t=>({padding:t.spacing.md,backgroundColor:t.colorScheme==="dark"?t.colors.dark[7]:t.colors.gray[0],borderRadius:t.radius.md,marginBottom:t.spacing.lg}),children:e.jsx(n,{size:"md",children:s.overview})}),e.jsx(b,{spacing:"md",mb:"xl",children:s.keyPoints.map((t,i)=>e.jsxs(c,{spacing:"sm",children:[e.jsx(M,{color:t.color,size:"lg",radius:"xl",children:e.jsx(t.icon,{size:18})}),e.jsx(n,{size:"sm",children:t.text})]},i))}),e.jsx(V,{my:"lg"}),e.jsxs(b,{spacing:"md",children:[e.jsx(D,{order:4,children:"Recommended Action"}),e.jsxs(R,{sx:t=>({padding:t.spacing.md,backgroundColor:t.colors.blue[7],color:"white",borderRadius:t.radius.md}),children:[e.jsx(n,{weight:500,children:s.recommendation.action}),e.jsx(n,{size:"sm",mt:4,style:{opacity:.9},children:s.recommendation.impact})]}),e.jsx(b,{spacing:"xs",children:s.recommendation.nextSteps.map((t,i)=>e.jsxs(c,{spacing:"xs",children:[e.jsxs(n,{size:"sm",color:"dimmed",children:[i+1,"."]}),e.jsx(n,{size:"sm",children:t})]},i))}),e.jsx(c,{position:"right",mt:"md",children:e.jsx(I,{variant:"light",rightIcon:e.jsx(ne,{size:16}),onClick:()=>{},children:"Take Action"})})]})]})},Nt=({title:s,count:t,description:i,icon:r,color:a,onClick:o})=>e.jsxs(C,{p:"md",radius:"md",withBorder:!0,onClick:o,sx:{cursor:o?"pointer":"default"},children:[e.jsxs(c,{position:"apart",mb:"xs",children:[e.jsx(M,{size:"xl",radius:"md",color:a,variant:"light",children:e.jsx(r,{size:24})}),e.jsx(n,{size:"xl",weight:700,children:t})]}),e.jsx(n,{size:"lg",weight:500,mb:"xs",children:s}),e.jsx(n,{size:"sm",color:"dimmed",children:i})]}),os=()=>{var u;const{activePatient:s}=Ce(),{user:t}=J(),i=((u=t==null?void 0:t.displayName)==null?void 0:u.split(" ")[0])||"there",r=F(),a=l=>{r(`/patients?view=${l}`)},o=[{title:"High Risk Patients",count:"5",description:"Patients requiring immediate attention",icon:_e,color:"red",view:G.HIGH_RISK},{title:"Care Gaps",count:"12",description:"Open care gaps to address",icon:ee,color:"blue",view:G.CARE_GAPS},{title:"Due for AWV",count:"8",description:"Annual Wellness Visits due this month",icon:We,color:"green",view:G.MISSING_AWV},{title:"Recent Visits",count:"15",description:"Patients seen in the last 7 days",icon:Rs,color:"grape",view:G.RECENT_VISITS}];return e.jsxs(E,{size:"xl",py:"xl",children:[e.jsxs(R,{pb:"xl",children:[e.jsxs(D,{order:1,mb:"lg",pl:"md",color:"dark.9",children:["Welcome, ",i]}),s&&e.jsx(R,{mb:"lg",children:e.jsx(Rt,{patient:s})})]}),e.jsx(P,{children:o.map((l,j)=>e.jsx(P.Col,{span:3,children:e.jsx(Nt,{...l,onClick:()=>a(l.view)})},j))}),e.jsx(Et,{})]})},Lt=(s,t)=>{try{localStorage.setItem(`gridState_${s}`,JSON.stringify(t))}catch(i){console.error("Error saving grid state:",i)}},Tt=s=>{try{const t=localStorage.getItem(`gridState_${s}`);return t?JSON.parse(t):null}catch(t){return console.error("Error loading grid state:",t),null}};Es.registerModules([Ns,Ls,Ts,Ms,Hs]);const Mt={".ag-theme-material":{"--ag-font-family":"var(--mantine-font-family)","--ag-font-size":"14px","--ag-header-height":"48px","--ag-header-background-color":"var(--mantine-color-gray-0)","--ag-header-foreground-color":"var(--mantine-color-dark-9)","--ag-header-column-separator-display":"block","--ag-header-column-separator-color":"var(--mantine-color-gray-3)","--ag-row-hover-color":"var(--mantine-color-gray-0)","--ag-selected-row-background-color":"var(--mantine-color-blue-0)","--ag-odd-row-background-color":"transparent","--ag-row-border-color":"var(--mantine-color-gray-2)","--ag-cell-horizontal-padding":"16px","--ag-borders":"none",border:"1px solid var(--mantine-color-gray-3)",borderRadius:"var(--mantine-radius-md)"},".ag-theme-material .ag-header-cell":{fontWeight:600},".ag-theme-material .ag-header-cell-text":{color:"var(--mantine-color-dark-9)"},".ag-theme-material .ag-cell":{display:"flex",alignItems:"center"},".ag-theme-material .ag-row":{borderBottom:"1px solid var(--mantine-color-gray-2)",cursor:"pointer"},".ag-theme-material .ag-row-selected":{backgroundColor:"var(--mantine-color-blue-0)"}};function ls(){const{patients:s,loading:t}=Ce(),i=x.useRef(null),[r,a]=x.useState([]),o=F(),[u]=Vs(),l=u.get("view"),j=x.useRef(!1);console.log("PatientList render:",{patients:s,patientsLoading:t,rowData:r}),x.useEffect(()=>{if(s!=null&&s.length){console.log("Raw patients data:",s);const y=s.map(w=>{var v;return{name:`${w.firstName} ${w.lastName}`,age:w.dateOfBirth?Ht(w.dateOfBirth):"",riskLevel:w.riskLevel||"low",lastVisit:w.lastVisit||"",careGaps:((v=w.careGaps)==null?void 0:v.length)||0,provider:w.provider||"",id:w.id}});console.log("Formatted grid data:",y),a(y)}else console.log("No patients data available:",s)},[s]);const[d]=x.useState([{field:"name",headerName:"Patient Name",filter:!0,checkboxSelection:!0,headerCheckboxSelection:!0,flex:2,minWidth:200,cellStyle:{fontWeight:500}},{field:"age",headerName:"Age",filter:"agNumberColumnFilter",width:100,type:"numericColumn",cellStyle:{justifyContent:"center"}},{field:"riskLevel",headerName:"Risk Level",filter:!0,cellRenderer:Vt,width:130,cellStyle:{display:"flex",alignItems:"center"},filterParams:{values:["low","medium","high"]}},{field:"lastVisit",headerName:"Last Visit",filter:"agDateColumnFilter",width:150,valueFormatter:y=>y.value?new Date(y.value).toLocaleDateString():""},{field:"careGaps",headerName:"Care Gaps",filter:"agNumberColumnFilter",width:120,type:"numericColumn",cellStyle:y=>({color:y.value>0?"#fa5252":"inherit",fontWeight:y.value>0?500:400,justifyContent:"center"})},{field:"provider",headerName:"Provider",filter:!0,flex:1,minWidth:150}]),m=x.useMemo(()=>({sortable:!0,resizable:!0,filter:!0,floatingFilter:!0,suppressMovable:!0,suppressMenu:!0}),[]),p=x.useCallback(y=>{console.log("Grid ready:",y);const w=Tt("patientsGrid");if(w&&i.current.columnApi.applyColumnState({state:w}),l&&!j.current){const v=Pe(l);y.api.setFilterModel(v),j.current=!0}y.api.sizeColumnsToFit()},[l]),h=()=>{const y=i.current.columnApi.getColumnState();Lt("patientsGrid",y)},g=x.useCallback(y=>{var w;if((w=i.current)!=null&&w.api){const v=Pe(y);i.current.api.setFilterModel(v)}},[]),S=x.useCallback(y=>{o(`/patients/${y.data.id}`)},[o]);return t?e.jsx(C,{p:"md",radius:"md",style:{height:"calc(100vh - 180px)"},children:e.jsx(c,{position:"center",style:{height:"100%"},children:e.jsx(ue,{size:"xl"})})}):e.jsxs(C,{p:"xl",radius:"md",style:{height:"calc(100vh - 180px)"},children:[e.jsxs(c,{position:"apart",mb:"xl",children:[e.jsxs(n,{size:"xl",weight:700,color:"dark.9",children:["Patient List (",r.length,")"]}),e.jsxs(c,{spacing:"sm",children:[e.jsxs(k,{position:"bottom-end",shadow:"md",children:[e.jsx(k.Target,{children:e.jsx(I,{variant:"light",leftIcon:e.jsx(Bs,{size:16}),size:"sm",children:"Filters"})}),e.jsxs(k.Dropdown,{children:[e.jsx(k.Label,{children:"Preset Filters"}),e.jsx(k.Item,{onClick:()=>g("highRisk"),children:"High Risk Patients"}),e.jsx(k.Item,{onClick:()=>g("recentVisits"),children:"Recent Visits"})]})]}),e.jsx(I,{variant:"light",leftIcon:e.jsx(Gs,{size:16}),onClick:()=>i.current.api.showToolPanel(),size:"sm",children:"Columns"}),e.jsx(I,{variant:"subtle",onClick:h,size:"sm",children:"Save View"})]})]}),e.jsx(R,{className:"ag-theme-material",sx:{height:"calc(100% - 60px)",width:"100%",...Mt},children:e.jsx(Os.AgGridReact,{ref:i,rowData:r,columnDefs:d,defaultColDef:m,rowSelection:"multiple",suppressRowClickSelection:!1,onGridReady:p,onRowClicked:S,sideBar:{toolPanels:["columns"],defaultToolPanel:""},domLayout:"autoHeight",enableBrowserTooltips:!0,rowHeight:48,headerHeight:48,pagination:!0,paginationPageSize:20,animateRows:!0,suppressCellFocus:!0})})]})}function Ht(s){const t=new Date,i=new Date(s);let r=t.getFullYear()-i.getFullYear();const a=t.getMonth()-i.getMonth();return(a<0||a===0&&t.getDate()<i.getDate())&&r--,r}const Vt=({value:s})=>{const t=()=>{switch(s==null?void 0:s.toLowerCase()){case"high":return{backgroundColor:"#ff6b6b",color:"white",border:"1px solid #fa5252"};case"medium":return{backgroundColor:"#ffd43b",color:"#212529",border:"1px solid #fab005"};case"low":return{backgroundColor:"#51cf66",color:"white",border:"1px solid #40c057"};default:return{backgroundColor:"#868e96",color:"white",border:"1px solid #495057"}}};return s?e.jsx(R,{sx:i=>({...t(),padding:"4px 12px",borderRadius:i.radius.sm,fontSize:i.fontSizes.sm,fontWeight:500,display:"inline-block",textTransform:"capitalize"}),children:s}):null},cs=()=>{const{user:s}=J(),{colorScheme:t,toggleColorScheme:i}=Fs(),[r,a]=x.useState({fhirServerUrl:"",debugMode:!1,notifications:!0,theme:t,language:"en",timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,dashboardLayout:"default",emailNotifications:{careGaps:!0,appointments:!0,riskScores:!0},displayPreferences:{compactView:!1,showMetricLabels:!0,defaultDateRange:"30days"}}),[o,u]=x.useState((s==null?void 0:s.displayName)||""),[l,j]=x.useState(!0),[d,m]=x.useState(!1),[p,h]=x.useState(!1),[g,S]=x.useState(null);x.useEffect(()=>{y()},[s]);const y=async()=>{try{const f=T(L,"userSettings",s.uid),H=await me(f);if(H.exists()){const ps=H.data();a(gs=>({...gs,...ps,theme:t}))}else await _(f,{...r,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()})}catch(f){console.error("Error loading settings:",f),S("Failed to load settings")}finally{j(!1)}},w=async()=>{try{m(!0);const f=T(L,"users",s.uid);await _(f,{displayName:o,updatedAt:new Date().toISOString()}),h(!0),setTimeout(()=>h(!1),3e3)}catch(f){S(f.message)}finally{m(!1)}},v=async()=>{try{m(!0);const f=T(L,"userSettings",s.uid);await _(f,{...r,theme:t,updatedAt:new Date().toISOString()}),he({title:"Settings Saved",message:"Your preferences have been updated successfully",color:"green"}),h(!0),setTimeout(()=>h(!1),3e3)}catch(f){console.error("Error saving settings:",f),S("Failed to save settings"),he({title:"Error",message:"Failed to save settings",color:"red"})}finally{m(!1)}};return e.jsx(E,{size:"md",py:"xl",children:e.jsxs(z,{defaultValue:"profile",children:[e.jsxs(z.List,{mb:"xl",children:[e.jsx(z.Tab,{value:"profile",icon:e.jsx(qe,{size:14}),children:"Profile"}),e.jsx(z.Tab,{value:"settings",icon:e.jsx(ge,{size:14}),children:"Application Settings"}),e.jsx(z.Tab,{value:"notifications",icon:e.jsx(Qe,{size:14}),children:"Notifications"})]}),g&&e.jsx(q,{icon:e.jsx(Q,{size:16}),title:"Error",color:"red",mb:"md",children:g}),p&&e.jsx(q,{icon:e.jsx(Us,{size:16}),title:"Success",color:"green",mb:"md",children:"Changes saved successfully"}),e.jsx(z.Panel,{value:"profile",children:e.jsx(C,{p:"xl",radius:"md",withBorder:!0,children:e.jsxs(b,{spacing:"xl",children:[e.jsxs(c,{children:[e.jsx(fe,{src:s==null?void 0:s.photoURL,size:"xl",radius:"xl"}),e.jsxs("div",{children:[e.jsx(ie,{label:"Display Name",value:o,onChange:f=>u(f.target.value),size:"md"}),e.jsx(n,{size:"sm",color:"dimmed",mt:4,children:s==null?void 0:s.email})]})]}),e.jsx(V,{}),e.jsx(c,{position:"right",children:e.jsx(I,{onClick:w,loading:d,children:"Save Profile"})})]})})}),e.jsx(z.Panel,{value:"settings",children:e.jsx(C,{p:"xl",radius:"md",withBorder:!0,children:e.jsxs(b,{spacing:"md",children:[e.jsx(ie,{label:"FHIR Server URL",description:"The URL of your FHIR server",value:r.fhirServerUrl,onChange:f=>a({...r,fhirServerUrl:f.target.value})}),e.jsx(K,{label:"Debug Mode",description:"Enable detailed logging",checked:r.debugMode,onChange:f=>a({...r,debugMode:f.target.checked})}),e.jsxs(c,{position:"apart",children:[e.jsx(n,{children:"Theme Mode"}),e.jsx(K,{checked:t==="dark",onChange:()=>i(),size:"lg",onLabel:e.jsx($s,{size:16,stroke:2.5}),offLabel:e.jsx(_s,{size:16,stroke:2.5})})]}),e.jsx(V,{label:"Display Preferences"}),e.jsx(K,{label:"Compact View",checked:r.displayPreferences.compactView,onChange:f=>a(H=>({...H,displayPreferences:{...H.displayPreferences,compactView:f.currentTarget.checked}}))}),e.jsx(K,{label:"Show Metric Labels",checked:r.displayPreferences.showMetricLabels,onChange:f=>a(H=>({...H,displayPreferences:{...H.displayPreferences,showMetricLabels:f.currentTarget.checked}}))}),e.jsx(ye,{label:"Default Date Range",value:r.displayPreferences.defaultDateRange,onChange:f=>a(H=>({...H,displayPreferences:{...H.displayPreferences,defaultDateRange:f}})),data:[{value:"7days",label:"Last 7 Days"},{value:"30days",label:"Last 30 Days"},{value:"90days",label:"Last 90 Days"},{value:"ytd",label:"Year to Date"}]}),e.jsx(c,{position:"right",mt:"xl",children:e.jsx(I,{onClick:v,loading:d,children:"Save Settings"})})]})})}),e.jsx(z.Panel,{value:"notifications",children:e.jsx(C,{p:"xl",radius:"md",withBorder:!0,children:e.jsxs(b,{spacing:"md",children:[e.jsx(K,{label:"Enable Notifications",description:"Receive system notifications",checked:r.notifications,onChange:f=>a({...r,notifications:f.target.checked})}),e.jsx(c,{position:"right",mt:"xl",children:e.jsx(I,{onClick:v,loading:d,children:"Save Notification Settings"})})]})})})]})})},ke=[{value:"all",label:"All Contracts"},{value:"cigna-ma",label:"Cigna Medicare Advantage"},{value:"humana-ma",label:"Humana Medicare Advantage"},{value:"aetna-ma",label:"Aetna Medicare Advantage"},{value:"uhc-ma",label:"UnitedHealthcare Medicare Advantage"}],Bt=({title:s,value:t,trend:i,description:r,icon:a,color:o})=>{const u=()=>i==="up"?e.jsx(Ye,{size:16,color:"#40c057"}):i==="down"?e.jsx(qs,{size:16,color:"#fa5252"}):e.jsx(Qs,{size:16});return e.jsxs(C,{p:"md",radius:"md",withBorder:!0,h:"100%",children:[e.jsxs(c,{position:"apart",mb:"xs",children:[e.jsx(M,{size:"xl",radius:"md",color:o,variant:"light",children:e.jsx(a,{size:24})}),e.jsxs(c,{spacing:"xs",children:[u(),e.jsxs(n,{size:"sm",color:i==="up"?"green":i==="down"?"red":"gray",children:[i==="up"?"+":i==="down"?"-":"",Math.abs(i),"%"]})]})]}),e.jsx(n,{size:"xl",weight:700,mb:"xs",children:t}),e.jsx(n,{size:"sm",weight:500,mb:"xs",children:s}),e.jsx(n,{size:"xs",color:"dimmed",children:r})]})},Gt=({contract:s,score:t,metrics:i})=>e.jsxs(C,{p:"xl",radius:"md",withBorder:!0,children:[e.jsxs(c,{position:"apart",mb:"lg",children:[e.jsxs(b,{spacing:0,children:[e.jsx(n,{size:"lg",weight:500,children:s}),e.jsx(n,{size:"sm",color:"dimmed",children:"VBC Success Score"})]}),e.jsx(Je,{size:80,thickness:8,sections:[{value:t,color:t>=75?"green":t>=50?"yellow":"red"}],label:e.jsxs(n,{size:"lg",weight:700,align:"center",children:[t,"%"]})})]}),e.jsx(P,{children:i.map((r,a)=>e.jsx(P.Col,{span:6,children:e.jsxs(c,{spacing:"xs",children:[e.jsxs(n,{size:"sm",color:"dimmed",children:[r.label,":"]}),e.jsx(n,{size:"sm",weight:500,children:r.value})]})},a))})]}),ds=()=>{const[s,t]=x.useState("all"),i={"cigna-ma":{score:82,metrics:[{label:"Quality Score",value:"85%"},{label:"RAF Score",value:"1.25"},{label:"Cost of Care",value:"$842 PMPM"},{label:"Member Satisfaction",value:"4.2/5"}]},"humana-ma":{score:75,metrics:[{label:"Quality Score",value:"78%"},{label:"RAF Score",value:"1.15"},{label:"Cost of Care",value:"$891 PMPM"},{label:"Member Satisfaction",value:"4.0/5"}]}},r=[{title:"Total Patients",value:"2,547",trend:12,description:"Active patients across all contracts",icon:pe,color:"blue"},{title:"Quality Score",value:"83%",trend:5,description:"Average across all contracts",icon:ee,color:"green"},{title:"RAF Score",value:"1.21",trend:8,description:"Risk adjustment factor",icon:Ke,color:"violet"},{title:"Shared Savings",value:"$1.2M",trend:15,description:"Projected annual savings",icon:Ws,color:"yellow"}];return e.jsxs(E,{size:"xl",py:"xl",children:[e.jsxs(c,{position:"apart",mb:"xl",children:[e.jsx(D,{order:2,children:"Performance Dashboard"}),e.jsx(ye,{value:s,onChange:t,data:ke,w:300})]}),e.jsx(P,{mb:"xl",children:r.map((a,o)=>e.jsx(P.Col,{span:3,children:e.jsx(Bt,{...a})},o))}),e.jsx(D,{order:3,mb:"lg",children:"Contract Performance"}),e.jsx(P,{children:Object.entries(i).map(([a,o],u)=>{var l;return e.jsx(P.Col,{span:6,children:e.jsx(Gt,{contract:(l=ke.find(j=>j.value===a))==null?void 0:l.label,score:o.score,metrics:o.metrics})},a)})})]})},Ot=[{value:"epic",label:"Epic"},{value:"cerner",label:"Cerner"},{value:"athena",label:"Athena Health"},{value:"allscripts",label:"Allscripts"}],Ft=({hcc:s,icdCode:t,description:i,rafValue:r,evidence:a=[]})=>{const[o,u]=x.useState(!1),[l,j]=x.useState(!1),[d,m]=x.useState(!1);return e.jsxs(C,{p:"md",radius:"md",withBorder:!0,mb:"sm",sx:p=>({minHeight:160,display:"flex",flexDirection:"column",justifyContent:"space-between"}),children:[e.jsxs(R,{children:[e.jsxs(c,{position:"apart",noWrap:!0,align:"flex-start",children:[e.jsxs(R,{children:[e.jsxs(c,{spacing:"xs",children:[e.jsx(n,{weight:500,children:s}),e.jsxs(N,{color:"blue",children:["RAF ",r]}),e.jsx(Xe,{label:"View ICD details",children:e.jsx(oe,{variant:"subtle",onClick:()=>m(!d),children:e.jsx(es,{size:16})})})]}),e.jsx(n,{size:"sm",color:"dimmed",mt:4,children:i})]}),e.jsxs(c,{spacing:"xs",children:[e.jsx(I,{size:"xs",color:"green",variant:o?"filled":"light",leftIcon:e.jsx(re,{size:16}),onClick:()=>u(!o),disabled:l,children:"Confirm"}),e.jsx(I,{size:"xs",color:"red",variant:l?"filled":"light",leftIcon:e.jsx(ss,{size:16}),onClick:()=>j(!l),disabled:o,children:"Deny"})]})]}),a.length>0&&e.jsxs(R,{mt:"md",children:[e.jsx(n,{size:"sm",weight:500,color:"dimmed",children:"Evidence:"}),e.jsx($,{size:"sm",spacing:"xs",mt:4,children:a.map((p,h)=>e.jsxs($.Item,{icon:e.jsx(M,{color:"blue",size:16,radius:"xl",children:e.jsx(re,{size:12})}),children:[e.jsx(n,{size:"sm",children:p.source}),e.jsx(n,{size:"xs",color:"dimmed",children:p.detail})]},h))})]})]}),e.jsx(Js,{in:d,children:e.jsxs(R,{mt:"md",p:"xs",bg:"gray.0",sx:{borderRadius:4},children:[e.jsx(n,{size:"sm",weight:500,color:"dimmed",children:"ICD-10 Codes:"}),e.jsx(c,{spacing:"xs",mt:4,children:t.map((p,h)=>e.jsx(N,{variant:"outline",children:p},h))})]})})]})},Ut=({patient:s,hccGaps:t,qualityGaps:i})=>e.jsx(Ze,{shadow:"sm",p:"md",radius:"md",withBorder:!0,mb:"md",children:e.jsxs(b,{spacing:"xs",children:[e.jsxs(c,{position:"apart",children:[e.jsxs(c,{children:[e.jsx(D,{order:4,children:s.name}),e.jsxs(n,{size:"sm",color:"dimmed",children:["DOB: ",s.dob]})]}),e.jsxs(N,{color:s.riskLevel==="high"?"red":"yellow",variant:"light",children:[s.riskLevel.toUpperCase()," Risk"]})]}),e.jsx(V,{my:"xs"}),e.jsx(n,{weight:500,size:"sm",children:"HCC Opportunities:"}),e.jsx($,{spacing:"xs",size:"sm",children:t.map((r,a)=>e.jsx($.Item,{icon:e.jsx(M,{color:"blue",size:20,radius:"xl",children:e.jsx(Ke,{size:12})}),children:e.jsx(Ft,{hcc:r.hcc,icdCode:r.icdCodes,description:r.description,rafValue:r.rafValue,evidence:r.evidence})},a))}),e.jsx(n,{weight:500,size:"sm",mt:"sm",children:"Quality Gaps:"}),e.jsx($,{spacing:"xs",size:"sm",children:i.map((r,a)=>e.jsxs($.Item,{icon:e.jsx(M,{color:"violet",size:20,radius:"xl",children:e.jsx(re,{size:12})}),children:[e.jsxs(c,{position:"apart",children:[e.jsx(n,{children:r.measure}),e.jsx(N,{color:"violet",variant:"light",children:r.type})]}),e.jsxs(n,{size:"xs",color:"dimmed",children:["Due by: ",r.dueDate]})]},a))}),e.jsx(V,{my:"xs"}),e.jsxs(c,{position:"apart",children:[e.jsxs(n,{size:"sm",color:"dimmed",children:["Next Visit: ",s.nextVisit]}),e.jsx(I,{variant:"light",size:"xs",rightIcon:e.jsx(ne,{size:16}),children:"View Patient Details"})]})]})}),hs=()=>{var o;const[s,t]=x.useState("epic"),[i,r]=x.useState("active"),a=[{name:"John Smith",dob:"05/15/1955",riskLevel:"high",nextVisit:"Today @ 2:30 PM",hccGaps:[{hcc:"HCC 108 - COPD",icdCodes:["J44.9","J44.1"],description:"Chronic Obstructive Pulmonary Disease",rafValue:"0.325",evidence:[{source:"Spirometry Results (01/15/2024)",detail:"FEV1/FVC ratio < 0.70, consistent with COPD"},{source:"Current Medications",detail:"Active prescription for Symbicort and Spiriva"},{source:"Progress Notes (12/10/2023)",detail:"Patient reports chronic cough and dyspnea on exertion"}]},{hcc:"HCC 18 - Diabetes with Chronic Complications",icdCodes:["E11.22","E11.51"],description:"Type 2 Diabetes with Multiple Complications",rafValue:"0.302",evidence:[{source:"Ophthalmology Consult (11/30/2023)",detail:"Mild diabetic retinopathy documented with fundus photos"},{source:"Lab Results (01/05/2024)",detail:"HbA1c: 8.2%, Microalbumin elevated"},{source:"Medication History",detail:"Multiple oral diabetes medications plus insulin"}]}],qualityGaps:[{measure:"Diabetes Eye Exam",type:"HEDIS",dueDate:"12/31/2024",evidence:"Last exam 11/30/2023 - Due annually"},{measure:"Annual Wellness Visit",type:"Medicare",dueDate:"03/15/2024",evidence:"Last AWV 03/15/2023"}]},{name:"Mary Johnson",dob:"08/22/1948",riskLevel:"high",nextVisit:"Today @ 3:45 PM",hccGaps:[{hcc:"HCC 85 - Congestive Heart Failure",icdCodes:["I50.22","I50.32"],description:"Systolic Heart Failure",rafValue:"0.368",evidence:[{source:"Echocardiogram (02/01/2024)",detail:"EF 35%, consistent with reduced ejection fraction"},{source:"Current Medications",detail:"Active prescriptions for Lasix and Lisinopril"},{source:"Recent ED Visit (01/15/2024)",detail:"Presented with dyspnea and peripheral edema"}]}],qualityGaps:[{measure:"Colorectal Cancer Screening",type:"HEDIS",dueDate:"12/31/2023",evidence:"Last colonoscopy > 10 years ago"},{measure:"Fall Risk Assessment",type:"Medicare",dueDate:"12/31/2023",evidence:"No documented assessment in past 12 months"}]}];return e.jsx(E,{size:"xl",py:"xl",children:e.jsxs(b,{spacing:"xl",children:[e.jsxs(c,{position:"apart",children:[e.jsxs(c,{children:[e.jsx(M,{size:"xl",radius:"md",color:"blue",children:e.jsx(Ve,{size:24})}),e.jsx(D,{order:2,children:"EHR Integration Alerts"})]}),e.jsx(ye,{value:s,onChange:t,data:[{value:"epic",label:"Epic"},{value:"cerner",label:"Cerner"},{value:"athena",label:"Athena Health"},{value:"allscripts",label:"Allscripts"}],style:{width:200}})]}),e.jsxs(C,{p:"md",withBorder:!0,children:[e.jsxs(c,{mb:"md",children:[e.jsx(Q,{size:20}),e.jsxs(n,{children:["Showing alerts for patients currently open in ",(o=Ot.find(u=>u.value===s))==null?void 0:o.label]})]}),e.jsxs(z,{value:i,onTabChange:r,children:[e.jsxs(z.List,{children:[e.jsx(z.Tab,{value:"active",icon:e.jsx(ee,{size:14}),children:"Active Patients"}),e.jsx(z.Tab,{value:"upcoming",icon:e.jsx(We,{size:14}),children:"Upcoming Visits"})]}),e.jsx(z.Panel,{value:"active",pt:"md",children:a.map((u,l)=>e.jsx(Ut,{patient:u,hccGaps:u.hccGaps,qualityGaps:u.qualityGaps},l))}),e.jsx(z.Panel,{value:"upcoming",pt:"md",children:e.jsx(n,{color:"dimmed",children:"No upcoming visits today"})})]})]})]})})},$t={async getCohortMetrics(){try{if(!Z.currentUser)throw new Error("User must be authenticated");console.log("Fetching cohort metrics...");const s=W(L,"cohortMetrics");return(await te(s)).docs.map(r=>({id:r.id,...r.data()}))}catch(s){throw console.error("Error fetching cohort metrics:",s),s}},async getCohortRecommendations(s){try{return(await te(W(L,`cohortMetrics/${s}/recommendations`))).docs.map(i=>({id:i.id,...i.data()}))}catch(t){return console.error("Error fetching recommendations:",t),[]}},async getPatientCarePathways(s){try{return(await te(je(W(L,"patientCarePathways"),Oe("patientId","==",s)))).docs.map(i=>({id:i.id,...i.data()}))}catch(t){return console.error("Error fetching care pathways:",t),[]}},async getPatientCareGaps(s){try{return(await this.getPatientCarePathways(s)).reduce((i,r)=>[...i,...r.careGaps],[])}catch(t){return console.error("Error fetching care gaps:",t),[]}},async updatePatientRiskLevel(s,t){try{const i=T(L,"patientCarePathways",s),r=await me(i);if(!r.exists())throw new Error("Pathway not found");const a=r.data();await _(i,{riskLevel:t,riskHistory:[...a.riskHistory||[],{level:t,timestamp:new Date().toISOString()}],updatedAt:new Date().toISOString()})}catch(i){throw console.error("Error updating risk level:",i),i}},subscribeToUpdates(s,t){return Ue(T(L,"cohortMetrics",s),i=>{i.exists()&&t(i.data())})}},_t=({cohort:s})=>e.jsx(Ze,{shadow:"sm",p:"lg",radius:"md",withBorder:!0,children:e.jsxs(b,{spacing:"md",children:[e.jsxs(c,{position:"apart",children:[e.jsxs(c,{children:[e.jsx(M,{size:"xl",radius:"md",variant:"light",children:e.jsx(s.icon,{size:24})}),e.jsxs("div",{children:[e.jsx(D,{order:4,children:s.name}),e.jsxs(n,{size:"sm",color:"dimmed",children:[s.patientCount," Patients"]})]})]}),e.jsx(Xe,{label:"View cohort details",children:e.jsx(oe,{variant:"light",size:"lg",children:e.jsx(es,{size:20})})})]}),e.jsxs("div",{children:[e.jsxs(c,{position:"apart",mb:5,children:[e.jsx(n,{size:"sm",children:"Risk Profile"}),e.jsxs(n,{size:"xs",color:"dimmed",children:[s.riskProfile.high," High Risk"]})]}),e.jsx(ve,{size:"lg",sections:[{value:s.riskProfile.high/s.patientCount*100,color:"red"},{value:s.riskProfile.medium/s.patientCount*100,color:"yellow"},{value:s.riskProfile.low/s.patientCount*100,color:"green"}]})]}),e.jsxs(c,{grow:!0,children:[e.jsxs("div",{children:[e.jsx(n,{size:"sm",children:"Care Gaps"}),e.jsx(n,{weight:700,size:"xl",color:"red",children:s.careGaps})]}),e.jsxs("div",{children:[e.jsx(n,{size:"sm",children:"Adherence"}),e.jsxs(n,{weight:700,size:"xl",color:s.adherence>=80?"green":"yellow",children:[s.adherence,"%"]})]})]}),e.jsx(V,{}),e.jsxs(b,{spacing:"xs",children:[e.jsx(n,{weight:500,children:"AI Recommendations:"}),s.recommendations.map((t,i)=>e.jsxs(C,{p:"xs",radius:"md",withBorder:!0,children:[e.jsxs(c,{position:"apart",mb:4,children:[e.jsx(n,{size:"sm",weight:500,children:t.title}),e.jsx(N,{color:t.priority==="high"?"red":"yellow",variant:"light",children:t.priority})]}),e.jsx(n,{size:"xs",color:"dimmed",mb:4,children:t.description}),e.jsx(n,{size:"xs",color:"blue",weight:500,children:t.impact})]},i))]}),e.jsx(I,{variant:"light",rightIcon:e.jsx(ne,{size:16}),fullWidth:!0,children:"View Care Pathways"})]})}),xs=()=>{const{user:s,loading:t}=J(),[i,r]=x.useState("cohorts"),[a,o]=x.useState([]),[u,l]=x.useState(!0),[j,d]=x.useState(null);return x.useEffect(()=>{!t&&s&&(async()=>{try{if(l(!0),s){const p=await $t.getCohortMetrics();o(p)}}catch(p){console.error("Error loading cohort data:",p),d(p.message)}finally{l(!1)}})()},[s,t]),t?e.jsx(E,{size:"xl",py:"xl",children:e.jsx(ae,{message:"Checking authentication..."})}):s?u?e.jsx(E,{size:"xl",py:"xl",children:e.jsx(ae,{message:"Loading cohort data..."})}):j?e.jsx(E,{size:"xl",py:"xl",children:e.jsx(q,{color:"red",title:"Error loading data",children:j})}):e.jsx(E,{size:"xl",py:"xl",children:e.jsxs(b,{spacing:"xl",children:[e.jsxs(c,{position:"apart",children:[e.jsxs(c,{children:[e.jsx(M,{size:"xl",radius:"md",variant:"light",color:"violet",children:e.jsx(Ks,{size:24})}),e.jsx(D,{order:2,children:"AI Care Recommendations"})]}),e.jsx(N,{variant:"dot",color:"green",size:"lg",children:"Updated 5 minutes ago"})]}),e.jsxs(z,{value:i,onTabChange:r,children:[e.jsxs(z.List,{children:[e.jsx(z.Tab,{value:"cohorts",icon:e.jsx(pe,{size:14}),children:"Condition Cohorts"}),e.jsx(z.Tab,{value:"pathways",icon:e.jsx(ee,{size:14}),children:"Care Pathways"}),e.jsx(z.Tab,{value:"metrics",icon:e.jsx(He,{size:14}),children:"Quality Metrics"})]}),e.jsx(z.Panel,{value:"cohorts",pt:"xl",children:e.jsx(P,{children:a.map(m=>e.jsx(P.Col,{md:6,children:e.jsx(_t,{cohort:m})},m.id))})}),e.jsx(z.Panel,{value:"pathways",pt:"xl"}),e.jsx(z.Panel,{value:"metrics",pt:"xl"})]})]})}):e.jsx(E,{size:"xl",py:"xl",children:e.jsx(q,{color:"red",title:"Authentication Required",children:"Please log in to view this page."})})},us=()=>{const s=F(),{notifications:t,loading:i,error:r}=X(l=>({notifications:l.notifications,loading:l.loading,error:l.error}));console.log("PatientContextHistory render:",{notifications:t,loading:i,error:r});const a=l=>new Date(l).toLocaleString(),o=l=>l==="browser"?e.jsx(st,{size:16}):e.jsx(tt,{size:16}),u=l=>{const{source:j="browser",appName:d}=l;return e.jsx(N,{leftSection:o(j),color:j==="browser"?"blue":"green",children:d||"Web Browser"})};return e.jsx(E,{size:"xl",py:"xl",children:e.jsxs(C,{p:"md",radius:"md",children:[e.jsxs(c,{position:"apart",mb:"xl",children:[e.jsx(D,{order:2,children:"Patient Context History"}),e.jsxs(c,{children:[!1,e.jsxs(N,{size:"lg",children:[t.length," Matches"]})]})]}),e.jsxs(Ys,{striped:!0,highlightOnHover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Patient Name"}),e.jsx("th",{children:"MRN"}),e.jsx("th",{children:"Source"}),e.jsx("th",{children:"Detected At"}),e.jsx("th",{children:"Actions"})]})}),e.jsxs("tbody",{children:[t.map(l=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx(n,{weight:500,children:l.patientInfo.name})}),e.jsx("td",{children:e.jsx(n,{color:"dimmed",children:l.patientInfo.mrn||"N/A"})}),e.jsx("td",{children:u(l)}),e.jsx("td",{children:e.jsx(n,{size:"sm",color:"dimmed",children:a(l.timestamp)})}),e.jsx("td",{children:e.jsxs(k,{position:"bottom-end",children:[e.jsx(k.Target,{children:e.jsx(oe,{children:e.jsx(Zs,{size:16})})}),e.jsxs(k.Dropdown,{children:[e.jsx(k.Item,{icon:e.jsx(Xs,{size:16}),onClick:()=>s(`/patients/${l.patientId}`),children:"View Patient"}),e.jsx(k.Item,{icon:e.jsx(et,{size:16}),color:"red",onClick:()=>X.getState().clearNotifications(),children:"Clear History"})]})]})})]},l.id)),t.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:e.jsx(n,{align:"center",color:"dimmed",py:"xl",children:"No patient context history found"})})})]})]})]})})};x.createContext();const Wt=({children:s})=>{const[t,i]=x.useState(localStorage.getItem("theme")||"light"),r=a=>{const o=a||(t==="dark"?"light":"dark");i(o),localStorage.setItem("theme",o)};return e.jsx(it,{colorScheme:t,toggleColorScheme:r,children:e.jsx(ts,{theme:{colorScheme:t,colors:{brand:["#6E2B81","#8A3A9B","#B82C5D","#8A2147"]}},withGlobalStyles:!0,withNormalizeCSS:!0,children:s})})},qt=()=>{const s=F(),{notifications:t,markAsRead:i,clearNotifications:r,getUnreadCount:a}=X(),o=a(),u=l=>{i(l.id),l.patientId&&s(`/patients/${l.patientId}`)};return e.jsxs(ce,{width:400,position:"bottom-end",children:[e.jsx(ce.Target,{children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(oe,{size:"lg",children:e.jsx(Qe,{size:20})}),o>0&&e.jsx(N,{size:"sm",variant:"filled",style:{position:"absolute",top:-5,right:-5},children:o})]})}),e.jsx(ce.Dropdown,{children:e.jsxs(b,{spacing:"md",children:[e.jsxs(c,{position:"apart",children:[e.jsx(n,{weight:500,size:"lg",children:"Notifications"}),t.length>0&&e.jsx(I,{variant:"subtle",size:"xs",onClick:()=>r(),children:"Clear All"})]}),e.jsx(R,{sx:{maxHeight:"400px",overflow:"auto"},children:e.jsx(b,{spacing:"md",children:t.length===0?e.jsx(n,{color:"dimmed",size:"sm",align:"center",py:"md",children:"No notifications"}):t.map(l=>e.jsx(I,{variant:l.read?"subtle":"light",color:l.read?"gray":"blue",fullWidth:!0,onClick:()=>u(l),styles:{root:{padding:"16px",height:"auto",textAlign:"left"},inner:{justifyContent:"flex-start"}},children:e.jsxs(b,{spacing:"xs",align:"flex-start",children:[e.jsx(n,{size:"sm",weight:500,lineClamp:2,children:l.title}),e.jsx(n,{size:"xs",color:"dimmed",lineClamp:2,children:l.message}),e.jsx(n,{size:"xs",color:"dimmed",children:new Date(l.timestamp).toLocaleString()})]})},l.id))})})]})})]})},Qt={initial:{opacity:0,x:-20},in:{opacity:1,x:0},exit:{opacity:0,x:20}},Jt={type:"tween",ease:"anticipate",duration:.5},O=({children:s})=>e.jsx(Be.div,{initial:"initial",animate:"in",exit:"exit",variants:Qt,transition:Jt,children:s}),Kt=({patient:s})=>{const t=[{name:"Chronic Conditions",score:3.2},{name:"Utilization History",score:2.1},{name:"Medication Adherence",score:1.8},{name:"Social Determinants",score:1.3}];return e.jsxs(C,{p:"md",radius:"md",children:[e.jsx(D,{order:3,mb:"md",children:"Risk Profile"}),e.jsxs(b,{spacing:"md",children:[e.jsxs(c,{position:"apart",children:[e.jsx(n,{size:"xl",weight:700,children:"8.4"}),e.jsx(N,{color:"red",children:"High Risk"})]}),e.jsxs(c,{spacing:"xs",children:[e.jsx(M,{color:"red",variant:"light",children:e.jsx(Ye,{size:16})}),e.jsx(n,{size:"sm",children:"+2.1 from last month"})]}),e.jsx(b,{spacing:"xs",children:t.map(i=>e.jsxs("div",{children:[e.jsxs(c,{position:"apart",mb:4,children:[e.jsx(n,{size:"sm",children:i.name}),e.jsx(n,{size:"sm",weight:500,children:i.score})]}),e.jsx(ve,{value:i.score*10,color:"red",size:"sm"})]},i.name))}),e.jsxs(c,{spacing:"xs",children:[e.jsx(M,{color:"yellow",variant:"light",children:e.jsx(_e,{size:16})}),e.jsx(n,{size:"sm",children:"Intervention recommended"})]})]})]})},Yt=({patient:s,detailed:t=!1})=>{const i=[{name:"HEDIS Measures",completed:12,total:15,color:"blue"},{name:"Care Gaps",completed:3,total:5,color:"orange"},{name:"Screenings",completed:8,total:10,color:"green"},{name:"Immunizations",completed:6,total:8,color:"violet"}];return e.jsxs(C,{p:"md",radius:"md",children:[e.jsx(D,{order:3,mb:"md",children:"Quality Metrics"}),e.jsx(P,{children:i.map(r=>e.jsx(P.Col,{span:t?6:3,children:e.jsxs(c,{noWrap:!0,align:"flex-start",children:[e.jsx(Je,{size:80,roundCaps:!0,thickness:8,sections:[{value:r.completed/r.total*100,color:r.color}],label:e.jsxs(n,{align:"center",size:"xs",weight:700,children:[Math.round(r.completed/r.total*100),"%"]})}),e.jsxs(b,{spacing:4,children:[e.jsx(n,{weight:500,children:r.name}),e.jsxs(n,{size:"sm",color:"dimmed",children:[r.completed," of ",r.total," complete"]}),t&&e.jsxs(n,{size:"xs",color:"dimmed",children:["Last updated: ",new Date().toLocaleDateString()]})]})]})},r.name))})]})},Zt=({patient:s})=>{const[t,i]=x.useState(!1),[r,a]=x.useState(null),[o,u]=x.useState(0),[l,j]=x.useState(""),d=[{id:1,title:"Annual Wellness Visit",priority:"high",dueDate:"2024-03-15",status:"overdue",description:"Patient has not completed annual wellness visit for 2024",attachments:[{name:"Previous_Visit_Summary.pdf",date:"2023-03-10"}]},{id:2,title:"Diabetes A1C Test",priority:"medium",dueDate:"2024-02-28",status:"pending",description:"Regular A1C monitoring required",attachments:[{name:"Lab_Results_2023.pdf",date:"2023-12-15"},{name:"Care_Plan.pdf",date:"2024-01-10"}]}],m=h=>{let g=0;const S=setInterval(()=>{g+=10,u(g),g>=100&&(clearInterval(S),h[0].name,new Date().toISOString().split("T")[0],setTimeout(()=>{u(0),i(!1),j("")},500))},200)},p=h=>{switch(h){case"high":return"red";case"medium":return"orange";case"low":return"blue";default:return"gray"}};return e.jsxs(e.Fragment,{children:[e.jsxs(C,{p:"md",radius:"md",children:[e.jsxs(c,{position:"apart",mb:"md",children:[e.jsx(D,{order:3,children:"Care Gaps"}),e.jsxs(N,{size:"lg",children:[d.length," Open"]})]}),e.jsx(b,{spacing:"md",children:d.map(h=>e.jsxs(C,{p:"md",radius:"md",withBorder:!0,children:[e.jsxs(c,{position:"apart",mb:"xs",children:[e.jsxs(c,{children:[e.jsx(M,{color:p(h.priority),variant:"light",size:"lg",children:e.jsx(Q,{size:20})}),e.jsxs("div",{children:[e.jsx(n,{weight:500,children:h.title}),e.jsxs(n,{size:"sm",color:"dimmed",children:["Due: ",h.dueDate]})]})]}),e.jsx(N,{color:p(h.priority),children:h.priority.toUpperCase()})]}),e.jsx(n,{size:"sm",mb:"md",children:h.description}),e.jsxs(c,{position:"apart",children:[e.jsx(c,{spacing:"xs",children:h.attachments.map((g,S)=>e.jsx(I,{variant:"light",size:"xs",leftIcon:e.jsx(rt,{size:14}),rightIcon:e.jsx(at,{size:14}),children:g.name},S))}),e.jsx(I,{size:"xs",leftIcon:e.jsx(de,{size:14}),onClick:()=>{a(h),i(!0)},children:"Upload"})]})]},h.id))})]}),e.jsx(nt,{opened:t,onClose:()=>i(!1),title:"Upload Documentation",size:"lg",children:e.jsxs(b,{spacing:"md",children:[e.jsxs(n,{weight:500,children:["Uploading for: ",r==null?void 0:r.title]}),e.jsx(se,{onDrop:m,maxSize:5*1024**2,accept:["application/pdf","image/*"],children:e.jsxs(c,{position:"center",spacing:"xl",style:{minHeight:120,pointerEvents:"none"},children:[e.jsx(se.Accept,{children:e.jsx(de,{size:50,stroke:1.5})}),e.jsx(se.Reject,{children:e.jsx(ss,{size:50,stroke:1.5})}),e.jsx(se.Idle,{children:e.jsx(de,{size:50,stroke:1.5})}),e.jsxs("div",{children:[e.jsx(n,{size:"xl",inline:!0,children:"Drag files here or click to select"}),e.jsx(n,{size:"sm",color:"dimmed",inline:!0,mt:7,children:"Files should not exceed 5MB"})]})]})}),o>0&&e.jsx(ve,{value:o,label:`${o}%`,size:"xl",radius:"xl"}),e.jsx(V,{}),e.jsx(ot,{label:"Additional Notes",placeholder:"Add any relevant notes about this documentation",value:l,onChange:h=>j(h.currentTarget.value),minRows:3}),e.jsxs(c,{position:"right",children:[e.jsx(I,{variant:"default",onClick:()=>i(!1),children:"Cancel"}),e.jsx(I,{children:"Upload"})]})]})})]})},Xt=({data:s})=>{const t=i=>{switch(i){case"condition":return{background:"#e03131",color:"white",border:"2px solid #c92a2a"};case"current":return{background:"#228be6",color:"white",border:"2px solid #1c7ed6"};case"recommended":return{background:"#40c057",color:"white",border:"2px solid #37b24d"};case"alternative":return{background:"#fab005",color:"white",border:"2px solid #f59f00"};default:return{background:"#868e96",color:"white",border:"2px solid #495057"}}};return e.jsxs("div",{style:{padding:"12px 20px",borderRadius:"8px",minWidth:"180px",textAlign:"center",...t(s.type)},children:[e.jsx(ze,{type:"target",position:Ie.Left}),e.jsxs("div",{children:[e.jsx(n,{size:"sm",weight:500,children:s.label}),s.severity&&e.jsx(N,{size:"sm",variant:"filled",color:"red",children:s.severity}),s.probability&&e.jsxs(N,{size:"sm",variant:"light",color:s.type==="current"?"blue":"gray",children:[Math.round(s.probability*100),"% probability"]}),s.details&&e.jsx(n,{size:"xs",color:"gray.2",mt:4,children:s.details})]}),e.jsx(ze,{type:"source",position:Ie.Right})]})},ei={pathway:Xt},si=({patient:s})=>{const{nodes:t,edges:i}=x.useMemo(()=>{const r=[{id:"diabetes",name:"Type 2 Diabetes",severity:"Uncontrolled",actions:[{id:"diabetes-med",label:"Medication Adjustment",type:"recommended",probability:.85,details:"Increase Metformin to 1000mg BID",outcomes:[{id:"diabetes-outcome",label:"Target HbA1c",probability:.75,details:"HbA1c < 7.0%"}]},{id:"diabetes-lifestyle",label:"Lifestyle Program",type:"alternative",probability:.65,details:"Diet & Exercise Plan",outcomes:[{id:"diabetes-outcome",label:"Target HbA1c",probability:.75,details:"HbA1c < 7.0%"}]}]},{id:"hypertension",name:"Hypertension",severity:"Stage 2",actions:[{id:"htn-med",label:"Add ACE Inhibitor",type:"recommended",probability:.9,details:"Start Lisinopril 10mg daily",outcomes:[{id:"htn-outcome",label:"BP Control",probability:.8,details:"BP < 130/80"}]}]}];let a=[],o=[];return r.forEach((u,l)=>{const j=l*200;a.push({id:u.id,type:"pathway",position:{x:50,y:j},data:{label:u.name,type:"condition",severity:u.severity}}),u.actions.forEach((d,m)=>{const p=j+m*100-(u.actions.length-1)*50;a.push({id:d.id,type:"pathway",position:{x:300,y:p},data:{label:d.label,type:d.type,probability:d.probability,details:d.details}}),o.push({id:`${u.id}-${d.id}`,source:u.id,target:d.id,type:"smoothstep",markerEnd:{type:Se.ArrowClosed},style:{stroke:d.type==="recommended"?"#40c057":"#fab005"}}),d.outcomes.forEach(h=>{const g={id:`${d.id}-${h.id}`,type:"pathway",position:{x:550,y:p},data:{label:h.label,type:"recommended",probability:h.probability,details:h.details}};a.find(S=>S.id===g.id)||a.push(g),o.push({id:`${d.id}-${h.id}`,source:d.id,target:`${d.id}-${h.id}`,type:"smoothstep",markerEnd:{type:Se.ArrowClosed},style:{stroke:"#40c057"}})})})}),{nodes:a,edges:o}},[s]);return e.jsxs(C,{p:"xl",radius:"md",children:[e.jsxs(c,{position:"apart",mb:"lg",children:[e.jsx(D,{order:3,children:"Care Pathway"}),e.jsx(n,{size:"sm",color:"dimmed",children:"Based on current conditions"})]}),e.jsx("div",{style:{height:500},children:e.jsxs(lt,{nodes:t,edges:i,nodeTypes:ei,fitView:!0,minZoom:.5,maxZoom:1.5,defaultViewport:{zoom:1},children:[e.jsx(ct,{}),e.jsx(dt,{})]})})]})},ms=()=>{var a;const{id:s}=ht(),{patients:t,loading:i}=Ce(),r=t==null?void 0:t.find(o=>o.id===s);return i?e.jsx(Ee,{style:{height:"calc(100vh - 200px)"},children:e.jsx(ue,{size:"xl"})}):r?e.jsxs(E,{size:"xl",py:"xl",children:[e.jsxs(C,{p:"xl",radius:"md",mb:"lg",children:[e.jsxs(c,{position:"apart",mb:"xl",children:[e.jsxs(b,{spacing:4,children:[e.jsxs(D,{order:2,children:[r.firstName," ",r.lastName]}),e.jsxs(n,{color:"dimmed",size:"sm",children:["DOB: ",new Date(r.dateOfBirth).toLocaleDateString()]})]}),e.jsxs(c,{children:[e.jsx(n,{weight:500,children:"Risk Level:"}),e.jsx(n,{weight:600,color:r.riskLevel==="high"?"red":r.riskLevel==="medium"?"yellow":"green",children:(a=r.riskLevel)==null?void 0:a.toUpperCase()})]})]}),e.jsxs(P,{children:[e.jsx(P.Col,{span:4,children:e.jsx(Kt,{patient:r})}),e.jsx(P.Col,{span:8,children:e.jsx(Yt,{patient:r})}),e.jsx(P.Col,{span:12,children:e.jsx(Zt,{patient:r})}),e.jsx(P.Col,{span:12,children:e.jsx(si,{patient:r})})]})]}),e.jsxs(P,{children:[e.jsx(P.Col,{span:6,children:e.jsx(C,{p:"xl",radius:"md",children:e.jsx(D,{order:3,mb:"lg",children:"Recent Activity"})})}),e.jsx(P.Col,{span:6,children:e.jsx(C,{p:"xl",radius:"md",children:e.jsx(D,{order:3,mb:"lg",children:"Care Plan"})})})]})]}):e.jsx(E,{size:"xl",py:"xl",children:e.jsx(C,{p:"xl",radius:"md",children:e.jsx(n,{align:"center",color:"dimmed",children:"Patient not found"})})})},ti=()=>{var r;const{user:s}=J(),t=F(),i=async()=>{try{await Z.signOut(),t("/login")}catch(a){console.error("Error logging out:",a)}};return e.jsx(xt,{height:60,children:e.jsx(R,{className:"animated-header",children:e.jsxs(c,{position:"apart",px:"md",h:"100%",w:"100%",children:[e.jsx(c,{spacing:"xs",align:"left",ml:"0",children:e.jsx("img",{src:"/arcadia-logo.svg",alt:"Arcadia.io",style:{height:24},className:"arcadia-logo"})}),e.jsx(n,{size:"xl",weight:700,className:"header-content",color:"white",children:"Galaxy Health"}),e.jsxs(c,{spacing:"md",children:[e.jsx(qt,{}),e.jsxs(k,{width:200,position:"bottom-end",shadow:"md",withArrow:!0,children:[e.jsx(k.Target,{children:e.jsx(ut,{children:e.jsx(fe,{size:"md",radius:"xl",src:s==null?void 0:s.photoURL,sx:a=>({border:`2px solid ${a.white}`,cursor:"pointer"}),children:(r=s==null?void 0:s.displayName)==null?void 0:r.charAt(0)})})}),e.jsxs(k.Dropdown,{children:[e.jsxs(k.Label,{children:[e.jsx(n,{size:"sm",weight:500,children:s==null?void 0:s.displayName}),e.jsx(n,{size:"xs",color:"dimmed",children:s==null?void 0:s.email})]}),e.jsx(V,{my:"xs"}),e.jsx(k.Item,{icon:e.jsx(qe,{size:14}),onClick:()=>t("/settings/profile"),children:"Profile"}),e.jsx(k.Item,{icon:e.jsx(ge,{size:14}),onClick:()=>t("/settings"),children:"Settings"}),e.jsx(V,{my:"xs"}),e.jsx(k.Item,{color:"red",icon:e.jsx(mt,{size:14}),onClick:i,children:"Logout"})]})]})]})]})})})},ii=Me(s=>({appShell:{main:{[s.fn.smallerThan("sm")]:{paddingBottom:"60px"}}}})),A=({children:s})=>{const{user:t,loading:i}=J();return i?e.jsx(ae,{}):t?s:e.jsx(be,{to:"/login"})},ri=()=>{const{classes:s}=ii(),{user:t}=J(),i=Le(),r=X(a=>a.initialize);return x.useEffect(()=>{const a=r();return()=>a==null?void 0:a()},[r]),t?e.jsx(ft,{padding:"md",navbar:e.jsx(zt,{}),header:e.jsx(ti,{}),classNames:{main:s.appShell.main},children:e.jsx(Te,{mode:"wait",children:e.jsxs(yt,{location:i,children:[e.jsx(B,{path:"/dashboard",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(os,{})})})}),e.jsx(B,{path:"/patients",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(ls,{})})})}),e.jsx(B,{path:"/patients/:id",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(ms,{})})})}),e.jsx(B,{path:"/settings",element:e.jsx(A,{children:e.jsx(cs,{})})}),e.jsx(B,{path:"/performance",element:e.jsx(A,{children:e.jsx(ds,{})})}),e.jsx(B,{path:"/ehr-alerts",element:e.jsx(A,{children:e.jsx(hs,{})})}),e.jsx(B,{path:"/ai-recommendations",element:e.jsx(A,{children:e.jsx(xs,{})})}),e.jsx(B,{path:"/patient-context",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(us,{})})})}),e.jsx(B,{path:"/",element:e.jsx(be,{to:"/dashboard",replace:!0})})]},i.pathname)})}):e.jsx(Dt,{})},ai=pt([{path:"/*",element:e.jsx(Ct,{children:e.jsx(At,{children:e.jsx(ri,{})})}),children:[{path:"dashboard",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(os,{})})})},{path:"patients",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(ls,{})})})},{path:"patients/:id",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(ms,{})})})},{path:"settings",element:e.jsx(A,{children:e.jsx(cs,{})})},{path:"performance",element:e.jsx(A,{children:e.jsx(ds,{})})},{path:"ehr-alerts",element:e.jsx(A,{children:e.jsx(hs,{})})},{path:"ai-recommendations",element:e.jsx(A,{children:e.jsx(xs,{})})},{path:"patient-context",element:e.jsx(A,{children:e.jsx(O,{children:e.jsx(us,{})})})},{path:"",element:e.jsx(be,{to:"/dashboard",replace:!0})}]}],{future:{v7_startTransition:!0,v7_relativeSplatPath:!0}}),ni=()=>e.jsx(Wt,{children:e.jsxs(ts,{withGlobalStyles:!0,withNormalizeCSS:!0,theme:{colorScheme:"light",primaryColor:"blue"},children:[e.jsx(gt,{position:"top-right"}),e.jsx(jt,{router:ai})]})});console.log("Starting app initialization...");vt.createRoot(document.getElementById("root")).render(e.jsx(Ne.StrictMode,{children:e.jsx(ni,{})}));
//# sourceMappingURL=index.CTAJKbeW.js.map
